#!/bin/bash
# This script sets up Nginx with a custom header and ensures the hostname is in place

# Exit on error
set -e

# Install Nginx
apt update
apt install -y nginx

# Configure custom header in Nginx
NGINX_CONFIG="/etc/nginx/sites-available/default"

# Add the X-Served-By custom header with the hostname value
if ! grep -q "add_header X-Served-By" $NGINX_CONFIG; then
    sed -i '/location \/ {/a \        add_header X-Served-By \"$HOSTNAME\";' $NGINX_CONFIG
fi

# Restart Nginx to apply changes
systemctl restart nginx
